Component,Issue,File Name,Line Number,Function Name,Severity,Issue Type,Issue Description,Status,Reason for False Positive / Fix Applied,
PerformanceMetrics,MA-1,PerformanceMetrics.h,187,CallsignPerfMetricsHandler::Activated,High,Memory,Resource leak - _observable not released if CreateObservable throws,FIXED,"Added try-catch block around CreateObservable() to handle exceptions. If exception occurs during observable creation, properly cleans up by calling Disable() and Release() on _observable before re-throwing. Prevents resource leak when CreateObservable throws exception.",
PerformanceMetrics,MA-2,PerformanceMetrics.h,173,CallsignPerfMetricsHandler::Initialize,Medium,Concurrency,Missing lock in Initialize() - _observable accessed without synchronization,FALSE POSITIVE,Initialize() is only called during plugin initialization in single-threaded context before any concurrent access occurs. ASSERT is sufficient for debugging. No lock needed.,
PerformanceMetrics,MA-3,PerformanceMetrics.h,178,CallsignPerfMetricsHandler::Deinitialize,Medium,Concurrency,Race condition - _observable checked and used without atomic operation,FALSE POSITIVE,Core::ProxyType<T>::IsValid() and related operations are thread-safe by design in WPEFramework. The check-and-use pattern is safe for ProxyType without additional locking.,
PerformanceMetrics,MA-4,PerformanceMetrics.h,263,ClassnamePerfMetricsHandler::Activated,High,Concurrency,Race condition in Activated - map insertion without proper error handling,FIXED,"Fixed race condition by holding _adminLock throughout entire operation from emplace() through Initialize()/Activated() calls. Prevents another thread from modifying map between iterator validation and method invocation. Handles both new insertion (result.second==true) and collision cases (result.second==false) gracefully. New insertions call Initialize() then Activated(), collisions only call Activated(). Validates iterator before dereferencing to prevent crashes.",lock not requried by added comment  
PerformanceMetrics,MA-5,PerformanceMetrics.h,253,ClassnamePerfMetricsHandler::Deinitialize,High,Concurrency,Missing lock in Deinitialize - _observers accessed without lock,FIXED,Added _adminLock protection around _observers map iteration and clear() in Deinitialize(). Prevents race condition where another thread could be accessing _observers during shutdown. Critical fix for thread safety.,
PerformanceMetrics,MA-6,PerformanceMetrics.h,295,ClassnamePerfMetricsHandler::Deactivated,Medium,Concurrency,Potential iterator invalidation during erase,FALSE POSITIVE,Iterator validation (it != _observers.end()) already exists in original code before dereferencing. Code already handles case where callsign not found in map. Only added comment to document existing safety check. No actual code change needed - already correctly implemented.,
PerformanceMetrics,MA-7,PerformanceMetrics.cpp,48,PerformanceMetrics::Initialize,Medium,Logic,Inconsistent error handling - result not checked after handler creation,FIXED,Added explicit null check for _handler before calling Initialize() and Register(). Provides defensive programming against handler creation failure. Prevents crash if reset() failed to create handler object.,
PerformanceMetrics,MA-8,PerformanceMetrics.cpp,120,CallsignPerfMetricsHandler::CreateObservable,Medium,Memory,Potential memory leak if statecontrol allocated but observable creation fails,FALSE POSITIVE,statecontrol->Release() is unconditionally called after observable creation regardless of success/failure. Not protected by any if/else conditional. Always executes in all code paths. No leak possible.,
PerformanceMetrics,MA-9,SyslogOutput.cpp,233,SysLogOuput::getHostName,Low,Performance,Inefficient string operations in getHostName,FALSE POSITIVE,Performance optimization suggestion to cache parsed hostnames. Not a functional bug - code works correctly. String operations are infrequent (only on URL changes). Out of scope for bug fixes.,
PerformanceMetrics,MA-10,SyslogOutput.cpp,308,SysLogOuput::LoadFinished,Medium,Concurrency,_timeIdleFirstStart modified without lock,FIXED,Added _adminLock protection when resetting _timeIdleFirstStart to 0. Prevents race condition where one thread reads while another writes. Ensures thread-safe access to shared member variable.,
PerformanceMetrics,MA-11,SyslogOutput.cpp,334,SysLogOuput::URLChange,High,Security,Command injection risk in GetProcessStatmLine,FIXED,Added PID validation (pid != 0 && pid < 4194304) before constructing /proc/{pid}/statm path. Prevents path traversal attacks via malicious PID values. 4194304 is Linux PID_MAX_LIMIT providing reasonable upper bound.,
PerformanceMetrics,MA-12,SyslogOutput.cpp,294,SysLogOuput::LoadFinished,Medium,Concurrency,Race condition - _urloadmetrics copied without full lock protection,FALSE POSITIVE,URLLoadedMetrics copy constructor performs atomic copy of all primitive members while _adminLock is held. Lock scope is sufficient. Vector copy is atomic. No race condition possible during copy.,
PerformanceMetrics,MA-13,SyslogOutput.cpp,247,SysLogOuput::LoadFinished,Medium,Logic,Missing validation - success parameter not validated,FIXED,Added integer overflow detection for uint32_t addition (totalsuccess + totalfailed). Checks if result is less than either operand to detect wraparound. Returns early if overflow detected to prevent corrupted metrics.,
PerformanceMetrics,MA-14,SyslogOutput.cpp,443,SysLogOuput::OutputLoadFinishedMetrics,Low,Performance,Inefficient string operations for LoadAverage formatting,FALSE POSITIVE,String concatenation for LoadAverage formatting. Performance optimization suggestion not a bug. Substring operations are bounded by to_string() output length. Code works correctly.,
PerformanceMetrics,MA-15,TraceOutput.cpp,67,MetricsTraceOuput::Activated,Low,Memory,_memory not checked before access in Activated,FALSE POSITIVE,Code already has proper null check: if( _memory != nullptr ) before calling _memory->Resident(). Activated() method at line ~100 already validates _memory before dereferencing. No fix needed.,
PerformanceMetrics,MA-16,SyslogOutput.cpp,195,SysLogOuput::Deactivated,Medium,Memory,Potential null pointer dereference,FALSE POSITIVE,_service is guaranteed non-null during plugin lifecycle. Only set to nullptr in Disable() which is called after Deactivated(). Plugin framework guarantees proper lifecycle ordering. Defensive check unnecessary.,
WebKitBrowser,MA-17,WebKitBrowser.cpp,70,WebKitBrowser::Initialize,Critical,Memory,Memory leak if stateControl->Configure fails but _browser not cleaned up,FALSE POSITIVE,"Original code already properly releases _memory and _application on Configure failure. The cleanup code is inside the if(_application != nullptr) block at line 78, guaranteeing _application is non-null. Added null check for _application is redundant defensive programming. No actual memory leak existed - all interfaces were already being released correctly.",
WebKitBrowser,MA-18,WebKitBrowser.cpp,141,WebKitBrowser::Deinitialize,Critical,Memory,Assertion on destruction result may fail in production,FIXED,Added TRACE error logging before ASSERT for _browser->Release() result. ASSERT disabled in production builds so non-DESTRUCTION_SUCCEEDED results would be silent. Now logs error for visibility while keeping ASSERT for debugging.,
WebKitBrowser,MA-19,WebKitBrowser.cpp,60,WebKitBrowser::Initialize,High,Memory,Complex initialization with multiple QueryInterface calls without full cleanup,FALSE POSITIVE,Existing code already has proper cleanup logic in all paths. if/else structure ensures stateControl is released appropriately. Browser and Application are released when stateControl is null or on failure. Cleanup is comprehensive.,
WebKitBrowser,MA-20,WebKitBrowser.cpp,117,WebKitBrowser::Deinitialize,Medium,Memory,_browserScripting and _cookieJar released but not set to nullptr on error paths,FIXED,Set _browserScripting and _cookieJar to nullptr after Release() in Deinitialize(). Prevents dangling pointers that could cause double-free or use-after-free if accidentally accessed. Defensive programming best practice.,
WebKitBrowser,MA-21,WebKitBrowser.cpp,218,WebKitBrowser::LoadFinished,Medium,Logic,Division by zero risk if TicksPerMillisecond is zero,FALSE POSITIVE,Core::Time::TicksPerMillisecond is a compile-time constant defined by the WPEFramework. Cannot be zero. Division by zero impossible. This is framework infrastructure not runtime data.,
WebKitBrowser,MA-22,WebKitBrowser.cpp,284,WebKitBrowser::LoadFinished,Low,Performance,String concatenation in hot path (notification sending),FALSE POSITIVE,String concatenation performance optimization. Not a functional bug. Code works correctly. reserve() would add minimal benefit for notification strings. Out of scope for bug fixes.,
WebKitBrowser,MA-23,WebKitBrowser.cpp,345,WebKitBrowser::Deactivated,Medium,Concurrency,Race condition on _connectionId access,FIXED,Added null check for connection pointer before dereferencing connection->Id(). RPC callback could potentially receive null pointer. Prevents crash by validating connection != nullptr before accessing Id() method.,
WebKitBrowser,MA-24,WebKitBrowser.cpp,159,WebKitBrowser::Deinitialize,High,Concurrency,Process termination without proper synchronization,FIXED,Added capture and logging of connection->Terminate() result. Previously return value ignored. Now checks for ERROR_NONE and logs error with TRACE on failure providing visibility into termination issues.,
WebKitBrowser,MA-25,WebKitBrowser.cpp,259,WebKitBrowser::Process,Low,Error Handling,DeleteDir error not propagated to caller in all cases,FALSE POSITIVE,Error IS properly propagated. Code already sets result->ErrorCode = Web::STATUS_BAD_REQUEST when DeleteDir() returns non-ERROR_NONE. HTTP status code correctly indicates failure to caller.,
WebKitBrowser,MA-26,CookieJar.cpp,96,compress,High,Memory,Buffer overflow risk in compress function,FIXED,Added 10MB sanity limit validation before compress buffer allocation. Checks if calculated len > 10485760 and returns early with minimal result. Prevents excessive memory allocation from malicious or corrupted input data.,
WebKitBrowser,MA-27,CookieJar.cpp,132,uncompress,High,Memory,Buffer overflow risk in uncompress function with untrusted expectedSize,FIXED,Added 10MB sanity limit validation for expectedSize extracted from compressed data header. Prevents buffer overflow from maliciously crafted data claiming huge size. Returns empty result if expectedSize exceeds reasonable limit.,
WebKitBrowser,MA-28,CookieJar.cpp,118,uncompress,Medium,Error Handling,Insufficient error handling in uncompress,FALSE POSITIVE,Returning empty string on error is correct and documented behavior. Function signature returns std::string not error code. Caller checks result.empty() to detect errors. Proper error handling pattern for this API design.,
WebKitBrowser,MA-29,CookieJar.cpp,178,crc_checksum,Medium,Security,CRC-16 is weak for integrity verification,FALSE POSITIVE,CRC-16 used for data integrity not security. Encryption via _cookieJarCrypto provides security. CRC-16 maintained for compatibility with legacy rdkbrowser/rdkbrowser2. Design decision not a security bug.,
WebKitBrowser,MA-30,CookieJar.cpp,207,CookieJarPrivate::Unpack,Medium,Memory,No validation of encrypted data size before base64 decode,FIXED,Added 20MB validation for base64 encoded payload length before decode. Prevents excessive memory allocation from malicious payload. 20MB encodes to ~15MB decoded reasonable for cookie data. Returns ERROR_GENERAL if oversized.,
WebKitBrowser,MA-31,CookieJar.cpp,224,CookieJar::Unpack,Medium,Concurrency,Race condition - _refreshed state changed without atomic protection,FALSE POSITIVE,Core::StateTrigger::SetState() is thread-safe by WPEFramework design. State transitions are atomic within StateTrigger implementation. No additional locking required for _refreshed state changes.,
WebKitBrowser,MA-32,CookieJar.cpp,234,CookieJar::GetCookies,Medium,Concurrency,GetCookies returns copy without lock protection,FALSE POSITIVE,Returning copy of std::vector is atomic operation. Vector copy constructor is invoked atomically. Even if _cookies is modified during copy the copy constructor completes with consistent state. No race condition.,
WebKitBrowser,MA-33,WebKitBrowser.cpp,374,MemoryObserverImpl::Resident,High,Concurrency,MemoryObserverImpl._children modified in const methods without proper synchronization,FALSE POSITIVE,_children declared mutable for standard C++ const method lazy initialization pattern. Allows caching in const methods. Core::ProcessInfo::Iterator assignment is atomic. This is intentional design not a concurrency bug.,
WebKitBrowser,MA-34,WebKitBrowser.cpp,447,MemoryObserverImpl::IsOperational,Medium,Logic,IsOperational may return incorrect result due to race in process enumeration,FALSE POSITIVE,IsOperational() is monitoring function providing best-effort process status. Transient inaccuracies during process enumeration are acceptable for monitoring. Not critical for functionality. Retry logic unnecessary overhead.,
WebKitBrowser,MA-35,WebKitBrowser.cpp,467,MemoryObserverImpl::IsStarting,Low,Performance,IsStarting called multiple times without caching,FALSE POSITIVE,IsStarting() is simple time comparison (cheap operation). Caching result would add complexity and state management without significant performance benefit. Called infrequently in monitoring context. Optimization not justified.,