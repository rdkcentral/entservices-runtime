Component,File Path,Line Number,Severity,Issue Type,Issue Description,Code Snippet,Suggested Fix,Source,
STL,/usr/include/c++/11/bits/hashtable.h,304,Unclassified,CTOR_DTOR_LEAK,"std::_Hashtable<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, WPEFramework::Plugin::PerformanceMetrics::CallsignPerfMetricsHandler>, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, WPEFramework::Plugin::PerformanceMetrics::CallsignPerfMetricsHandler> >, std::__detail::_Select1st, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, std::__detail::_Hashtable_traits<true, false, true> >::_Scoped_node::_Scoped_node<std::piecewise_construct_t const &, std::tuple<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > &&>, std::tuple<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > &&> >(std::__detail::_Hashtable_alloc<std::allocator<std::__detail::_Hash_node<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, WPEFramework::Plugin::PerformanceMetrics::CallsignPerfMetricsHandler>, true> > > *, <std::piecewise_construct_t const &, std::tuple<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > &&>, std::tuple<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > &&>...> &&...)",,Coverity,,
STL,/usr/include/c++/11/bits/hashtable.h,304,Unclassified,CTOR_DTOR_LEAK,"std::_Hashtable<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, WPEFramework::PluginHost::JSONRPC::Observer>, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, WPEFramework::PluginHost::JSONRPC::Observer> >, std::__detail::_Select1st, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, std::__detail::_Hashtable_traits<true, false, true> >::_Scoped_node::_Scoped_node<std::piecewise_construct_t const &, std::tuple<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const &>, std::tuple<> >(std::__detail::_Hashtable_alloc<std::allocator<std::__detail::_Hash_node<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, WPEFramework::PluginHost::JSONRPC::Observer>, true> > > *, <std::piecewise_construct_t const &, std::tuple<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const &>, std::tuple<>...> &&...)",,Coverity,,
STL,/usr/include/c++/11/bits/hashtable.h,304,Unclassified,CTOR_DTOR_LEAK,"std::_Hashtable<unsigned int, std::pair<unsigned int const, WPEFramework::RPC::Communicator::RemoteConnection *>, std::allocator<std::pair<unsigned int const, WPEFramework::RPC::Communicator::RemoteConnection *> >, std::__detail::_Select1st, std::equal_to<unsigned int>, std::hash<unsigned int>, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, std::__detail::_Hashtable_traits<false, false, true> >::_Scoped_node::_Scoped_node<std::piecewise_construct_t const &, std::tuple<unsigned int &&>, std::tuple<WPEFramework::RPC::Communicator::RemoteConnection *&> >(std::__detail::_Hashtable_alloc<std::allocator<std::__detail::_Hash_node<std::pair<unsigned int const, WPEFramework::RPC::Communicator::RemoteConnection *>, false> > > *, <std::piecewise_construct_t const &, std::tuple<unsigned int &&>, std::tuple<WPEFramework::RPC::Communicator::RemoteConnection *&>...> &&...)",,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/JSON.h,2486,Unclassified,INTEGER_OVERFLOW,"WPEFramework::Core::JSON::Buffer::Serialize(unsigned char *, unsigned short, unsigned int &) const",,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/JSON.h,3617,Unclassified,INTEGER_OVERFLOW,"WPEFramework::Core::JSON::Container::Serialize(char *, unsigned short, unsigned int &) const",,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/IPCConnector.h,116,Unclassified,INTEGER_OVERFLOW,"WPEFramework::Core::IMessage::Serializer::Serialize(unsigned char *, unsigned short)",,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/JSON.h,3631,Unclassified,INTEGER_OVERFLOW,"WPEFramework::Core::JSON::Container::Serialize(char *, unsigned short, unsigned int &) const",,Coverity,,
WPEFramework,install/usr/include/WPEFramework/com/Communicator.h,1193,Unclassified,INVALIDATE_ITERATOR,"WPEFramework::RPC::Communicator::RemoteConnectionMap::Request(WPEFramework::Core::ProxyType<WPEFramework::Core::IPCChannelClientType<WPEFramework::RPC::Communicator::ChannelLink, false, false> > &, WPEFramework::RPC::Data::Init const &)",,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/ResourceMonitor.h,336,Unclassified,MISSING_LOCK,"WPEFramework::Core::ResourceMonitorType<WPEFramework::Core::IResource, WPEFramework::Core::Void>::Initialize()",,Coverity,,
PerformanceMetrics,PerformanceMetrics/PerformanceMetrics.h,253,Unclassified,MISSING_LOCK,WPEFramework::Plugin::PerformanceMetrics::ClassnamePerfMetricsHandler::Deinitialize(),,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/Proxy.h,1516,Unclassified,MISSING_LOCK,"WPEFramework::Core::ProxyPoolType<WPEFramework::Core::IPCMessageType<1u, WPEFramework::Core::IPC::BufferType<(unsigned short)10240>, WPEFramework::Core::IPC::BufferType<(unsigned short)10240> > >::CreatedElements() const",,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/Proxy.h,1520,Unclassified,MISSING_LOCK,"WPEFramework::Core::ProxyPoolType<WPEFramework::Core::IPCMessageType<1u, WPEFramework::Core::IPC::BufferType<(unsigned short)10240>, WPEFramework::Core::IPC::BufferType<(unsigned short)10240> > >::QueuedElements() const",,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/ResourceMonitor.h,391,Unclassified,MISSING_LOCK,"WPEFramework::Core::ResourceMonitorType<WPEFramework::Core::IResource, WPEFramework::Core::Void>::Worker()",,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/ThreadPool.h,427,Unclassified,MISSING_LOCK,WPEFramework::Core::ThreadPool::Minion::Process(),,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/Timer.h,358,Unclassified,MISSING_LOCK,WPEFramework::Core::TimerType<WPEFramework::Core::WorkerPool::Timer>::Process(),,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/Timer.h,362,Unclassified,REVERSE_INULL,WPEFramework::Core::TimerType<WPEFramework::Core::WorkerPool::Timer>::Process(),,Coverity,,
WPEFramework,install/usr/include/WPEFramework/messaging/MessageUnit.h,750,Unclassified,STACK_USE,"WPEFramework::Messaging::MessageUnit::MessageDispatcher::MetaDataBuffer::MetadataFrameHandler::Procedure(WPEFramework::Core::IPCChannel &, WPEFramework::Core::ProxyType<WPEFramework::Core::IIPC> &)",,Coverity,,
WPEFramework,install/usr/include/WPEFramework/core/FileObserver.h,240,Unclassified,STRING_NULL,WPEFramework::Core::FileSystemMonitor::Handle(unsigned short),,Coverity,,
WPEFramework,install/usr/include/WPEFramework/com/IUnknown.h,229,Unclassified,UNUSED_VALUE,WPEFramework::ProxyStub::UnknownProxy::Release() const,,Coverity,,
PerformanceMetrics,PerformanceMetrics/PerformanceMetrics.h,187,High,Memory,Resource leak - _observable not released if CreateObservable throws,void Activated(PluginHost::IShell& service) override { if( service.Callsign() == _callsign ) { ASSERT(_observable.IsValid() == false); CreateObservable(service); _observable->Activated(service); } },Add exception handling or ensure cleanup on failure path,Manual Analysis,
PerformanceMetrics,PerformanceMetrics/PerformanceMetrics.h,173,Medium,Concurrency,Missing lock in Initialize() - _observable accessed without synchronization,void Initialize() override { ASSERT(_observable.IsValid() == false); },Add lock protection for _observable access,Manual Analysis,
PerformanceMetrics,PerformanceMetrics/PerformanceMetrics.h,178,Medium,Concurrency,Race condition - _observable checked and used without atomic operation,void Deinitialize() override { if( _observable.IsValid() == true ) { _observable->Disable(); ... } },Use lock or atomic operations for _observable state check and usage,Manual Analysis,
PerformanceMetrics,PerformanceMetrics/PerformanceMetrics.h,263,High,Concurrency,Race condition in Activated - map insertion without proper error handling,auto result =_observers.emplace(...); ASSERT( ( result.second == true ) && ( result.first != _observers.end() ) );,Check emplace result before dereferencing and handle collision gracefully,Manual Analysis,
PerformanceMetrics,PerformanceMetrics/PerformanceMetrics.h,253,High,Concurrency,Missing lock in Deinitialize - _observers accessed without lock,void Deinitialize() override { for( auto& observer : _observers ) { observer.second.Deinitialize(); } _observers.clear(); },Lock _adminLock before accessing _observers map,Manual Analysis,
PerformanceMetrics,PerformanceMetrics/PerformanceMetrics.h,271,Medium,Concurrency,Potential iterator invalidation during erase,_observers.erase(it);,Ensure no other thread holds reference to iterator during erase,Manual Analysis,
PerformanceMetrics,PerformanceMetrics.cpp,48,Medium,Logic,Inconsistent error handling - result not checked after handler creation,if( result.empty() == true ) { ASSERT(_handler); _handler->Initialize(); service->Register(&_notification); } else { Deinitialize(service); },Add explicit null check for _handler before calling Initialize(),Manual Analysis,
PerformanceMetrics,PerformanceMetrics.cpp,120,Medium,Memory,Potential memory leak if statecontrol allocated but observable creation fails,if( statecontrol != nullptr ) { statecontrol->Release(); },Move Release() inside try-catch or ensure it's called on all paths,Manual Analysis,Invaild/false postive
PerformanceMetrics,SyslogOutput.cpp,294,Medium,Concurrency,Race condition - _urloadmetrics copied without full lock protection,_adminLock.Lock(); URLLoadedMetrics metrics(_urloadmetrics); _adminLock.Unlock();,Ensure URLLoadedMetrics copy constructor is thread-safe or extend lock scope,Manual Analysis,
PerformanceMetrics,SyslogOutput.cpp,308,Medium,Concurrency,_timeIdleFirstStart modified without lock,_timeIdleFirstStart = 0;,Protect _timeIdleFirstStart with _adminLock,Manual Analysis,
PerformanceMetrics,SyslogOutput.cpp,334,High,Security,Command injection risk in GetProcessStatmLine,"std::string procPath = std::string(""/proc/"") + std::to_string(pid) + ""/statm"";",Validate pid value to prevent path traversal attacks,Manual Analysis,
PerformanceMetrics,SyslogOutput.cpp,233,Low,Performance,Inefficient string operations in getHostName,"return _URL.substr(startIdx, endIdx - startIdx);",Consider caching parsed hostnames,Manual Analysis,
PerformanceMetrics,SyslogOutput.cpp,247,Medium,Logic,Missing validation - success parameter not validated,"OutputLoadFinishedMetrics(metrics, getHostName(URL), urllaunchtime_ms, success, totalsuccess + totalfailed);",Add bounds check for totalsuccess and totalfailed before addition,Manual Analysis,
PerformanceMetrics,SyslogOutput.cpp,195,Medium,Memory,Potential null pointer dereference,if(_memory != nullptr) { _memory->Release(); _memory = nullptr; },Check _memory before Release in all code paths,Manual Analysis,
PerformanceMetrics,TraceOutput.cpp,67,Low,Memory,_memory not checked before access in Activated,"TRACE(Trace::Metric, (_T(""Plugin %s activated, RSS: %llu""), _callsign.c_str(), _memory->Resident()));",Add null check before dereferencing _memory,Manual Analysis,
WebKitBrowser,WebKitBrowser/WebKitBrowser.cpp,70,Critical,Memory,Memory leak if stateControl->Configure fails but _browser not cleaned up,if (stateControl->Configure(_service) != Core::ERROR_NONE) { if (_memory != nullptr) { _memory->Release(); _memory = nullptr; } ... _browser->Release(); _browser = nullptr; },Ensure all QueryInterface results are released on failure,Manual Analysis,
WebKitBrowser,WebKitBrowser/WebKitBrowser.cpp,141,Critical,Memory,Assertion on destruction result may fail in production,VARIABLE_IS_NOT_USED uint32_t result = _browser->Release(); ASSERT(result == Core::ERROR_DESTRUCTION_SUCCEEDED);,Handle non-DESTRUCTION_SUCCEEDED cases gracefully in production,Manual Analysis,
WebKitBrowser,WebKitBrowser/WebKitBrowser.cpp,60,High,Memory,Complex initialization with multiple QueryInterface calls without full cleanup,_application = _browser->QueryInterface<Exchange::IApplication>(); if (_application != nullptr) { _browser->Register(&_notification); ... },Add comprehensive cleanup for all acquired interfaces on any failure,Manual Analysis,
WebKitBrowser,WebKitBrowser/WebKitBrowser.cpp,117,Medium,Memory,_browserScripting and _cookieJar released but not set to nullptr on error paths,if (_browserScripting) { Exchange::JBrowserScripting::Unregister(*this); _browserScripting->Release(); },Set pointers to nullptr after Release() to prevent double-free,Manual Analysis,
WebKitBrowser,WebKitBrowser/WebKitBrowser.cpp,218,Medium,Logic,Division by zero risk if TicksPerMillisecond is zero,uint64_t urllaunchtime_ms = ( ( Core::Time::Now().Ticks() - metrics.StartLoad() ) / Core::Time::TicksPerMillisecond);,Add check for Core::Time::TicksPerMillisecond before division,Manual Analysis,
WebKitBrowser,WebKitBrowser/WebKitBrowser.cpp,284,Low,Performance,String concatenation in hot path (notification sending),"string message(string(""{ \""url\"": \"""") + URL + string(""\""...""));",Use string builder or reserve capacity for better performance,Manual Analysis,
WebKitBrowser,WebKitBrowser.cpp,345,Medium,Concurrency,Race condition on _connectionId access,if (connection->Id() == _connectionId),Protect _connectionId access with synchronization,Manual Analysis,
WebKitBrowser,WebKitBrowser/WebKitBrowser.cpp,159,High,Concurrency,Process termination without proper synchronization,connection->Terminate(); connection->Release();,Add timeout and error handling for Terminate(),Manual Analysis,
WebKitBrowser,WebKitBrowser/WebKitBrowser.cpp,259,Low,Error Handling,DeleteDir error not propagated to caller in all cases,if (DeleteDir(request.Body<const Data>()->Path.Value()) != Core::ERROR_NONE) { result->ErrorCode = Web::STATUS_BAD_REQUEST; },Add more specific error messages for different failure scenarios,Manual Analysis,
WebKitBrowser,WebKitBrowser/CookieJar.cpp,96,High,Memory,Buffer overflow risk in compress function,"result.resize(len + 4); status = ::compress2((unsigned char*)result.data() + 4, &len, (const unsigned char*)str.c_str(), nbytes, compressionLevel);",Validate len value before using in resize and buffer operations,Manual Analysis,
WebKitBrowser,WebKitBrowser/CookieJar.cpp,132,High,Memory,Buffer overflow risk in uncompress function with untrusted expectedSize,"unsigned long expectedSize = (unsigned long)( (data[0] << 24) | (data[1] << 16) | (data[2] << 8) | (data[3])); unsigned long len = std::max(expectedSize, 1ul);",Validate expectedSize against reasonable limits before allocation,Manual Analysis,
WebKitBrowser,WebKitBrowser/CookieJar.cpp,118,Medium,Error Handling,Insufficient error handling in uncompress,"if (nbytes <= 4) { if (nbytes < 4 || std::any_of(...)) { TRACE_GLOBAL(Trace::Error,(...)); } return result; }",Return error code instead of empty result for better error propagation,Manual Analysis,
WebKitBrowser,WebKitBrowser/CookieJar.cpp,178,Medium,Security,CRC-16 is weak for integrity verification,static const unsigned short crc_tbl[16] = { ... }; ... return ~crc & 0xffff;,Use cryptographic hash (SHA256) instead of CRC-16 for security,Manual Analysis,
WebKitBrowser,WebKitBrowser/CookieJar.cpp,207,Medium,Memory,No validation of encrypted data size before base64 decode,"rc = _cookieJarCrypto.Decrypt(fromBase64(payload), version, decrypted);",Validate payload size before decode to prevent excessive memory allocation,Manual Analysis,
WebKitBrowser,WebKitBrowser/CookieJar.cpp,224,Medium,Logic,Race condition - _refreshed state changed without atomic protection,_refreshed.SetState( false );,Verify StateTrigger provides atomic state transitions,Manual Analysis,
WebKitBrowser,WebKitBrowser/CookieJar.cpp,234,Medium,Concurrency,GetCookies returns copy without lock protection,std::vector<std::string> CookieJar::GetCookies() const { return _cookies; },Add mutex protection for _cookies access,Manual Analysis,
WebKitBrowser,WebKitBrowser/WebKitBrowser.cpp,374,High,Concurrency,MemoryObserverImpl._children modified in const methods without proper synchronization,if (_children.Count() < RequiredChildren) { _children = Core::ProcessInfo::Iterator(_main.Id()); },Add mutable mutex and lock all access to _children,Manual Analysis,
WebKitBrowser,WebKitBrowser/WebKitBrowser.cpp,447,Medium,Logic,IsOperational may return incorrect result due to race in process enumeration,while ((requiredProcesses != 0) && (true == _children.Next())) { ... },Add retry logic or timeout for process enumeration,Manual Analysis,
WebKitBrowser,WebKitBrowser/WebKitBrowser.cpp,467,Low,Performance,IsStarting called multiple times without caching,return (((requiredProcesses == 0) || (true == IsStarting())) && (true == _main.IsActive()));,Cache IsStarting result to avoid repeated time comparisons,Manual Analysis,